# TASK-0026-00-00: Extract Theme System for Color Mappings

## Task Context

- **Priority**: P0
- **Effort**: M (Medium)
- **Status**: Not Started
- **Goal**: Replace hard-coded color mappings with configurable theme system using strategy pattern

## Current State Analysis

### Hard-coded Color Locations Identified:

#### 1. Tailwind Config (`tailwind.config.js`)

```javascript
colors: {
    // Custom colors for lifecycle states
    draft: '#ef4444', // red-500
    review: '#f97316', // orange-500
    approved: '#3b82f6', // blue-500
    ready: '#10b981', // emerald-500
    implemented: '#059669', // emerald-600
    validated: '#047857', // emerald-700
    deprecated: '#6b7280', // gray-500

    // Task states
    'not-started': '#ef4444', // red-500
    'in-progress': '#f97316', // orange-500
    blocked: '#991b1b', // red-800
    complete: '#10b981', // emerald-500
    abandoned: '#6b7280', // gray-500

    // Architecture states
    proposed: '#f97316', // orange-500
    accepted: '#10b981', // emerald-500
    rejected: '#ef4444' // red-500
}
```

#### 2. Component Color Functions (Duplicated across 3 files)

**Requirements Page** (`src/routes/requirements/+page.svelte:64-85`):

- `getStatusColor()` - Maps RequirementStatus to colors
- `getPriorityColor()` - Maps Priority to colors

**Tasks Page** (`src/routes/tasks/+page.svelte:74-103`):

- `getStatusColor()` - Maps TaskStatus to colors
- `getPriorityColor()` - Maps Priority to colors
- `getEffortColor()` - Maps EffortSize to colors

**Architecture Page** (`src/routes/architecture/+page.svelte:53-61`):

- `getStatusColor()` - Maps architecture status to colors

#### 3. Direct Tailwind Classes in Components (9 files affected)

Files with hard-coded bg-, text-, border- classes:

- `/routes/+layout.svelte`
- `/lib/components/ProjectName.svelte`
- `/routes/settings/+page.svelte`
- `/routes/tasks/+page.svelte`
- `/routes/requirements/+page.svelte`
- `/lib/components/SortableTable.svelte`
- `/routes/architecture/+page.svelte`
- `/routes/+page.svelte`
- `/lib/components/ErrorNotification.svelte`

## Implementation Strategy

### Phase 1: Theme System Architecture

1. Create `src/lib/theme/` directory structure:
   - `theme-types.ts` - Theme interfaces and types
   - `theme-provider.ts` - Theme context/store management
   - `default-themes.ts` - Light, dark, high-contrast themes
   - `theme-utils.ts` - Color mapping utilities

### Phase 2: Centralized Color Mapping

1. Create theme-aware color mapping functions:
   - `getStatusColors(status, theme)` - Unified status color mapping
   - `getPriorityColors(priority, theme)` - Unified priority color mapping
   - `getEffortColors(effort, theme)` - Unified effort color mapping
   - `getSemanticColors(semantic, theme)` - Layout/UI colors

### Phase 3: Component Refactoring

1. Remove duplicate color functions from components
2. Replace with centralized theme utilities
3. Update direct Tailwind classes to use theme-aware classes
4. Add theme provider to layout

### Phase 4: Theme Configuration

1. Update Tailwind config to use CSS custom properties
2. Implement theme switching mechanism
3. Add theme persistence (localStorage)
4. Test all themes across components

## Acceptance Criteria Verification

✅ **Create configurable theme system with strategy pattern**

- Theme provider with pluggable theme objects
- Interface-based theme definitions
- Strategy pattern for theme switching

✅ **Remove hard-coded color mappings from components**

- Eliminate duplicate getStatusColor/getPriorityColor functions
- Replace hard-coded Tailwind classes
- Centralize color logic

✅ **Support multiple themes (light, dark, high-contrast)**

- Default light theme (current colors)
- Dark theme with appropriate contrast
- High-contrast theme for accessibility

✅ **Theme changes apply across all components consistently**

- Single source of truth for colors
- Reactive theme updates
- Consistent color application

✅ **Theme system is easily extensible for new color schemes**

- Plugin architecture for custom themes
- Clear theme definition interfaces
- Easy theme registration system

## Files to Create

```
src/lib/theme/
├── theme-types.ts           # TypeScript interfaces
├── theme-provider.ts        # Svelte store/context
├── default-themes.ts        # Built-in theme definitions
├── theme-utils.ts          # Color mapping utilities
└── index.ts                # Public API exports
```

## Files to Modify

```
tailwind.config.js          # CSS custom properties
src/routes/+layout.svelte    # Theme provider integration
src/routes/requirements/+page.svelte  # Remove color functions
src/routes/tasks/+page.svelte         # Remove color functions
src/routes/architecture/+page.svelte  # Remove color functions
```

## Implementation Notes

- Use CSS custom properties for theme values
- Maintain backward compatibility during transition
- Ensure accessibility compliance (WCAG contrast ratios)
- Add theme switching UI component
- Include theme persistence across sessions
- Document theme creation guide for extensibility

## Test Requirements

- Unit tests for theme utilities
- Visual regression tests for all themes
- Accessibility tests for high-contrast theme
- Theme switching integration tests

## Ready for Implementation

This task is fully documented and ready for implementation in a fresh context. All hard-coded color locations have been identified and a clear migration path has been established.
